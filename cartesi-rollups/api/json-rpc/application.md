---
id: application
title: Application
resources:
  - url: https://github.com/cartesi/rollups-contracts/tree/main/contracts/dapp
    title: Application contract
  - url: https://docs.openzeppelin.com/contracts/5.x/
    title: OpenZeppelin Contracts
---

The **Application** contract acts as the base layer incarnation of a dApp running on the execution layer. The dApp is hereby able to interact with other smart contracts through the execution and the validation of outputs. These outputs are generated by the dApp frontend on the execution layer and can be proven in the base layer thanks to claims submitted by a consensus contract.

Every dApp is subscribed to a consensus contract, and governed by a single address, the owner. The consensus has the power of submitting claims, which, in turn, are used to validate vouchers and notices. The owner has complete power over the dApp, as it can replace the consensus at any time. Therefore, the users of a dApp must trust both the consensus and the dApp owner.

The dApp developer can choose whichever ownership and consensus models it wants.

Examples of dApp ownership models include:

- no owner (address zero)
- individual signer (externally-owned account)
- multiple signers (multi-sig)
- DAO (decentralized autonomous organization)
- self-owned dApp (off-chain governance logic)

See `IConsensus` for examples of consensus models.

This contract inherits the following OpenZeppelin contracts.

- `Ownable`
- `ERC721Holder`
- `ERC1155Holder`
- `ReentrancyGuard`

For more information, please consult [OpenZeppelin's official documentation](https://docs.openzeppelin.com/contracts/4.x/).

## `executeOutput()`

```solidity
function executeOutput(bytes calldata output, OutputValidityProof calldata proof) external nonReentrant
```

Executes an output based on the provided output data and validity proof.

Reverts if the output is not executable or if the output has already been executed.

Emits an `OutputExecuted` event upon successful execution.

| Name   | Type                | Description                            |
| ------ | ------------------- | -------------------------------------- |
| output | bytes               | Output data to be executed             |
| proof  | OutputValidityProof | Proof validating the output's validity |

## `migrateToConsensus()`

```solidity
function migrateToConsensus(IConsensus newConsensus) external onlyOwner
```

Migrates the application to a new consensus contract.

_Can only be called by the dApp owner._

#### Parameters

| Name         | Type       | Description                          |
| ------------ | ---------- | ------------------------------------ |
| newConsensus | IConsensus | New consensus contract to migrate to |

## `wasOutputExecuted()`

```solidity
function wasOutputExecuted(uint256 inputIndex, uint256 outputIndexWithinInput) external view returns (bool)
```

Checks if an output has been previously executed.

#### Parameters

| Name                   | Type    | Description                                     |
| ---------------------- | ------- | ----------------------------------------------- |
| inboxInputIndex        | uint256 | Index of the input associated with the output   |
| outputIndexWithinInput | uint256 | Index of the output within its associated input |

#### Return Values

| Type | Description                                        |
| ---- | -------------------------------------------------- |
| bool | Boolean indicating whether the output was executed |

## `validateOutput()`

```solidity
function validateOutput(bytes calldata output, OutputValidityProof calldata proof) external view
```

Validates an output based on the provided output data and validity proof.

_Reverts if the output is invalid_.

#### Parameters

| Name   | Type                | Description                            |
| ------ | ------------------- | -------------------------------------- |
| output | bytes               | Output data to be validated            |
| proof  | OutputValidityProof | Proof validating the output's validity |

## `getTemplateHash()`

```solidity
function getTemplateHash() external view returns (bytes32)
```

Returns the initial machine state hash of the application.

#### Return Values

| Type    | Description                                   |
| ------- | --------------------------------------------- |
| bytes32 | Initial machine state hash of the application |

## `getConsensus()`

```solidity
function getConsensus() external view returns (contract IConsensus)
```

Returns the current consensus contract used by the application.

#### Return Values

| Type       | Description                                        |
| ---------- | -------------------------------------------------- |
| IConsensus | Current consensus contract used by the application |

## `getInputBox()`

```solidity
function getInputBox() external view returns (IInputBox)
```

Returns the input box contract associated with the application.

#### Return Values

| Type      | Description                                        |
| --------- | -------------------------------------------------- |
| IInputBox | Input box contract associated with the application |


## `getPortals()`

```solidity
function getPortals() external view returns (IPortal[] memory)
```
Returns an array of portals supported by the application.

#### Return Values

| Type      | Description                                        |
| --------- | -------------------------------------------------- |
| IPortal[]| Array of portals supported by the application |



## `supportsInterface()`

```solidity
function supportsInterface(bytes4 interfaceId) public view returns (bool)
```
Checks whether the contract implements the specified interface.

#### Parameters

| Name | Type      | Description                                        |
| --------- | --------- | -------------------------------------------------- |
|  interfaceId    | bytes4 | Interface identifier |

#### Return Values

| Type      | Description                                        |
| --------- | -------------------------------------------------- |
| bool | 	Boolean indicating whether the interface is supported |




## `_executeVoucher()`

```solidity
function executeVoucher(address _destination, bytes _payload, struct Proof _proof) external returns (bool)
```

Executes a voucher, which involves calling a specified contract with encoded arguments.

_Reverts if the call to the contract fails_.


#### Parameters

| Name          | Type         | Description                                                                                        |
| ------------- | ------------ | -------------------------------------------------------------------------------------------------- |
| arguments | bytes      | 	ABI-encoded arguments for the contract call                            |

